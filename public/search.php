<?php
// Початковий текст
$text = "Я бачу у вікно громаддя хмар,
Холодних, білосніжних, як зимою,
І ніжно-голубе, яскраве небо.
Осінній день погожий, і на північ
Відходять хмари. Клени золоті
І під балконом дві березки білі
Просвічують на небі всохлим листям.";

// Масив для збереження слів
$words = [];
$currentWord = "";
$index = 0;

// Обробляємо текст посимвольно
while (isset($text[$index])) {
    $byte = $text[$index];

    // Перевіряємо, чи це початок нового UTF-8 символу (перший байт)
    if (($byte & "\xC0") !== "\x80") {
        // Якщо це літера (спрощена перевірка для кирилиці та латиниці)
        if (
            ($byte >= "\xD0" && $byte <= "\xD3") || // Кирилиця
            ($byte >= 'A' && $byte <= 'Z') ||       // Великі літери латиниці
            ($byte >= 'a' && $byte <= 'z')          // Малі літери латиниці
        ) {
            $currentWord .= $byte;
        } else {
            // Якщо зустріли пробіл або символ, завершуємо поточне слово
            if ($currentWord !== "") {
                $words[] = $currentWord;
                $currentWord = "";
            }
        }
    } else {
        // Якщо це частина багатобайтового символу, додаємо до поточного слова
        $currentWord .= $byte;
    }

    $index++; // Наступний байт
}

// Додаємо останнє слово, якщо залишилося
if ($currentWord !== "") {
    $words[] = $currentWord;
}

// Відбираємо слова довжиною від 5 до 7 символів
$result = [];
foreach ($words as $word) {
    $charCount = 0; // Лічильник символів у слові
    $i = 0;

    // Рахуємо символи у слові
    while (isset($word[$i])) {
        $byte = $word[$i];

        // Перевіряємо, чи це початок символу
        if (($byte & "\xC0") !== "\x80") {
            $charCount++; // Збільшуємо лічильник символів
        }

        $i++; // Наступний байт
    }

    // Додаємо слово, якщо воно має від 5 до 7 символів
    if ($charCount >= 5 && $charCount <= 7) {
        $result[] = $word;
    }
}

// Виведення результатів
if (!empty($result)) {
    echo "Слова довжиною від 5 до 7 символів:\n";
    foreach ($result as $word) {
        echo "<br>" . $word . "\n";
    }
} else {
    echo "Слова не знайдено.\n";
}

?>
